{
  
    
        "post0": {
            "title": "Title",
            "content": "# Load the Drive helper and mount from google.colab import drive # This will prompt for authorization. drive.mount(&#39;/content/drive&#39;) %cd &#39;/content/drive/My Drive/dhoa.github.io&#39; !git config --global user.email &quot;dienhoa.t@gmail.com&quot; !git config --global user.name &quot;dienhoa&quot; !git add . !git commit -m &quot;first commit&quot; !git push origin master . Go to this URL in a browser: https://accounts.google.com/o/oauth2/auth?client_id=947318989803-6bn6qk8qdgf4n4g3pfee6491hc0brc4i.apps.googleusercontent.com&amp;redirect_uri=urn%3aietf%3awg%3aoauth%3a2.0%3aoob&amp;response_type=code&amp;scope=email%20https%3a%2f%2fwww.googleapis.com%2fauth%2fdocs.test%20https%3a%2f%2fwww.googleapis.com%2fauth%2fdrive%20https%3a%2f%2fwww.googleapis.com%2fauth%2fdrive.photos.readonly%20https%3a%2f%2fwww.googleapis.com%2fauth%2fpeopleapi.readonly Enter your authorization code: ·········· Mounted at /content/drive . %cd &#39;/content/drive/My Drive/dhoa.github.io&#39; . /content/drive/My Drive/dhoa.github.io . !git config --global user.email &quot;dienhoa.t@gmail.com&quot; !git config --global user.name &quot;Hoa&quot; . !git status . On branch master Your branch is ahead of &#39;origin/master&#39; by 1 commit. (use &#34;git push&#34; to publish your local commits) Changes not staged for commit: (use &#34;git add &lt;file&gt;...&#34; to update what will be committed) (use &#34;git checkout -- &lt;file&gt;...&#34; to discard changes in working directory) modified: _notebooks/loss_func.ipynb no changes added to commit (use &#34;git add&#34; and/or &#34;git commit -a&#34;) . !git remote -v . origin https://github.com/dienhoa/dhoa.github.io.git (fetch) origin https://github.com/dienhoa/dhoa.github.io.git (push) . !git add . . !git commit -m &quot;first commit&quot; . *** Please tell me who you are. Run git config --global user.email &#34;you@example.com&#34; git config --global user.name &#34;Your Name&#34; to set your account&#39;s default identity. Omit --global to set the identity only in this repository. fatal: unable to auto-detect email address (got &#39;root@f2754affe9a3.(none)&#39;) . !git config --global user.email &quot;dienhoa.t@gmail.com&quot; !git config --global user.name &quot;dienhoa&quot; . !git commit -m &quot;first commit&quot; . On branch master Your branch is ahead of &#39;origin/master&#39; by 1 commit. (use &#34;git push&#34; to publish your local commits) Changes not staged for commit: modified: _notebooks/loss_func.ipynb no changes added to commit . !git remote add origin https://dienhoa:&lt;password&gt;github@github.com/&lt;username&gt;/reponame.git . !git push origin master . fatal: could not read Username for &#39;https://github.com&#39;: No such device or address . !pip install fastai2 !pip install nbdev . Collecting fastai2 Downloading https://files.pythonhosted.org/packages/26/4f/0f61bb0d376eb47c20430639bac4946ca0cffcd7e693fb86698656324f2d/fastai2-0.0.17-py3-none-any.whl (190kB) |████████████████████████████████| 194kB 5.3MB/s Requirement already satisfied: fastprogress&gt;=0.1.22 in /usr/local/lib/python3.6/dist-packages (from fastai2) (0.2.3) Collecting fastcore Downloading https://files.pythonhosted.org/packages/dd/f3/8cd2e1ed981b0ddbe4d56e5d44f52c9e56d27ac7d53c30abb534d10c82c2/fastcore-0.1.17-py3-none-any.whl Requirement already satisfied: matplotlib in /usr/local/lib/python3.6/dist-packages (from fastai2) (3.2.1) Requirement already satisfied: spacy in /usr/local/lib/python3.6/dist-packages (from fastai2) (2.2.4) Requirement already satisfied: pyyaml in /usr/local/lib/python3.6/dist-packages (from fastai2) (3.13) Requirement already satisfied: pillow in /usr/local/lib/python3.6/dist-packages (from fastai2) (7.0.0) Requirement already satisfied: torch&gt;=1.3.0 in /usr/local/lib/python3.6/dist-packages (from fastai2) (1.5.0+cu101) Requirement already satisfied: scikit-learn in /usr/local/lib/python3.6/dist-packages (from fastai2) (0.22.2.post1) Requirement already satisfied: torchvision&gt;=0.5 in /usr/local/lib/python3.6/dist-packages (from fastai2) (0.6.0+cu101) Requirement already satisfied: pandas in /usr/local/lib/python3.6/dist-packages (from fastai2) (1.0.3) Requirement already satisfied: requests in /usr/local/lib/python3.6/dist-packages (from fastai2) (2.21.0) Requirement already satisfied: scipy in /usr/local/lib/python3.6/dist-packages (from fastai2) (1.4.1) Requirement already satisfied: numpy in /usr/local/lib/python3.6/dist-packages (from fastcore-&gt;fastai2) (1.18.3) Requirement already satisfied: dataclasses&gt;=&#39;0.7&#39;; python_version &lt; &#34;3.7&#34; in /usr/local/lib/python3.6/dist-packages (from fastcore-&gt;fastai2) (0.7) Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib-&gt;fastai2) (2.4.7) Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib-&gt;fastai2) (1.2.0) Requirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib-&gt;fastai2) (2.8.1) Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.6/dist-packages (from matplotlib-&gt;fastai2) (0.10.0) Requirement already satisfied: tqdm&lt;5.0.0,&gt;=4.38.0 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (4.38.0) Requirement already satisfied: murmurhash&lt;1.1.0,&gt;=0.28.0 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (1.0.2) Requirement already satisfied: preshed&lt;3.1.0,&gt;=3.0.2 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (3.0.2) Requirement already satisfied: srsly&lt;1.1.0,&gt;=1.0.2 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (1.0.2) Requirement already satisfied: catalogue&lt;1.1.0,&gt;=0.0.7 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (1.0.0) Requirement already satisfied: blis&lt;0.5.0,&gt;=0.4.0 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (0.4.1) Requirement already satisfied: thinc==7.4.0 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (7.4.0) Requirement already satisfied: cymem&lt;2.1.0,&gt;=2.0.2 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (2.0.3) Requirement already satisfied: setuptools in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (46.1.3) Requirement already satisfied: plac&lt;1.2.0,&gt;=0.9.6 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (1.1.3) Requirement already satisfied: wasabi&lt;1.1.0,&gt;=0.4.0 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (0.6.0) Requirement already satisfied: future in /usr/local/lib/python3.6/dist-packages (from torch&gt;=1.3.0-&gt;fastai2) (0.16.0) Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.6/dist-packages (from scikit-learn-&gt;fastai2) (0.14.1) Requirement already satisfied: pytz&gt;=2017.2 in /usr/local/lib/python3.6/dist-packages (from pandas-&gt;fastai2) (2018.9) Requirement already satisfied: idna&lt;2.9,&gt;=2.5 in /usr/local/lib/python3.6/dist-packages (from requests-&gt;fastai2) (2.8) Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.6/dist-packages (from requests-&gt;fastai2) (2020.4.5.1) Requirement already satisfied: urllib3&lt;1.25,&gt;=1.21.1 in /usr/local/lib/python3.6/dist-packages (from requests-&gt;fastai2) (1.24.3) Requirement already satisfied: chardet&lt;3.1.0,&gt;=3.0.2 in /usr/local/lib/python3.6/dist-packages (from requests-&gt;fastai2) (3.0.4) Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.6/dist-packages (from python-dateutil&gt;=2.1-&gt;matplotlib-&gt;fastai2) (1.12.0) Requirement already satisfied: importlib-metadata&gt;=0.20; python_version &lt; &#34;3.8&#34; in /usr/local/lib/python3.6/dist-packages (from catalogue&lt;1.1.0,&gt;=0.0.7-&gt;spacy-&gt;fastai2) (1.6.0) Requirement already satisfied: zipp&gt;=0.5 in /usr/local/lib/python3.6/dist-packages (from importlib-metadata&gt;=0.20; python_version &lt; &#34;3.8&#34;-&gt;catalogue&lt;1.1.0,&gt;=0.0.7-&gt;spacy-&gt;fastai2) (3.1.0) Installing collected packages: fastcore, fastai2 Successfully installed fastai2-0.0.17 fastcore-0.1.17 Collecting nbdev Downloading https://files.pythonhosted.org/packages/19/54/f39f9050f0e1610c4c5f764872812ef72615dac70ea7f1c9bc20948acb04/nbdev-0.2.18-py3-none-any.whl (45kB) |████████████████████████████████| 51kB 3.0MB/s Requirement already satisfied: packaging in /usr/local/lib/python3.6/dist-packages (from nbdev) (20.3) Requirement already satisfied: nbformat&gt;=4.4.0 in /usr/local/lib/python3.6/dist-packages (from nbdev) (5.0.6) Requirement already satisfied: pyyaml in /usr/local/lib/python3.6/dist-packages (from nbdev) (3.13) Collecting fastscript Downloading https://files.pythonhosted.org/packages/55/0e/ecdc0213646bc82986884121109a38b50bbc2cd2c491bbbfdc7ae39228e3/fastscript-0.1.4-py3-none-any.whl Requirement already satisfied: nbconvert&gt;=5.6.1 in /usr/local/lib/python3.6/dist-packages (from nbdev) (5.6.1) Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from packaging-&gt;nbdev) (1.12.0) Requirement already satisfied: pyparsing&gt;=2.0.2 in /usr/local/lib/python3.6/dist-packages (from packaging-&gt;nbdev) (2.4.7) Requirement already satisfied: jsonschema!=2.5.0,&gt;=2.4 in /usr/local/lib/python3.6/dist-packages (from nbformat&gt;=4.4.0-&gt;nbdev) (2.6.0) Requirement already satisfied: jupyter-core in /usr/local/lib/python3.6/dist-packages (from nbformat&gt;=4.4.0-&gt;nbdev) (4.6.3) Requirement already satisfied: ipython-genutils in /usr/local/lib/python3.6/dist-packages (from nbformat&gt;=4.4.0-&gt;nbdev) (0.2.0) Requirement already satisfied: traitlets&gt;=4.1 in /usr/local/lib/python3.6/dist-packages (from nbformat&gt;=4.4.0-&gt;nbdev) (4.3.3) Requirement already satisfied: defusedxml in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev) (0.6.0) Requirement already satisfied: entrypoints&gt;=0.2.2 in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev) (0.3) Requirement already satisfied: testpath in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev) (0.4.4) Requirement already satisfied: mistune&lt;2,&gt;=0.8.1 in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev) (0.8.4) Requirement already satisfied: bleach in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev) (3.1.4) Requirement already satisfied: jinja2&gt;=2.4 in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev) (2.11.2) Requirement already satisfied: pandocfilters&gt;=1.4.1 in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev) (1.4.2) Requirement already satisfied: pygments in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev) (2.1.3) Requirement already satisfied: decorator in /usr/local/lib/python3.6/dist-packages (from traitlets&gt;=4.1-&gt;nbformat&gt;=4.4.0-&gt;nbdev) (4.4.2) Requirement already satisfied: webencodings in /usr/local/lib/python3.6/dist-packages (from bleach-&gt;nbconvert&gt;=5.6.1-&gt;nbdev) (0.5.1) Requirement already satisfied: MarkupSafe&gt;=0.23 in /usr/local/lib/python3.6/dist-packages (from jinja2&gt;=2.4-&gt;nbconvert&gt;=5.6.1-&gt;nbdev) (1.1.1) Installing collected packages: fastscript, nbdev Successfully installed fastscript-0.1.4 nbdev-0.2.18 . from fastai2.vision.all import * . path = untar_data(URLs.PETS) . items = get_image_files(path/&#39;images&#39;) . item = items[0] . item . Path(&#39;/root/.fastai/data/oxford-iiit-pet/images/basset_hound_23.jpg&#39;) . item.stem[0].isupper() . False . def label_func(fname): return &quot;cat&quot; if fname.name[0].isupper() else &quot;dog&quot; . labeller = RegexLabeller(pat=r&quot;(.+)_ d+.jpg&quot;) . pets = DataBlock(blocks=(ImageBlock, CategoryBlock), get_items=get_image_files, splitter=RandomSplitter(), get_y = Pipeline([lambda x: getattr(x,&#39;name&#39;), labeller]), item_tfms=Resize(224), batch_tfms=aug_transforms(), ) . dls = pets.dataloaders(path/&#39;images&#39;) . dls.show_batch() . learn = cnn_learner(dls, resnet18, loss_func=our_cross_entropy, metrics=error_rate) . learn = cnn_learner(dls, resnet18, loss_func=inverse_loss, metrics=error_rate) . learn = cnn_learner(dls, resnet18, loss_func=dot_product_loss, metrics=error_rate) . learn.fine_tune(1) . epoch train_loss valid_loss error_rate time . 0 | 1.357865 | 1.076573 | 0.139378 | 00:50 | . epoch train_loss valid_loss error_rate time . 0 | 1.115083 | 1.058115 | 0.104195 | 00:50 | . learn.fine_tune(1) . epoch train_loss valid_loss error_rate time . 0 | 1.824922 | 1.162176 | 0.155616 | 00:49 | . epoch train_loss valid_loss error_rate time . 0 | 1.248410 | 1.107818 | 0.102842 | 00:50 | . learn.fine_tune(1) . epoch train_loss valid_loss error_rate time . 0 | 1.642085 | 0.396497 | 0.125169 | 00:50 | . epoch train_loss valid_loss error_rate time . 0 | 0.557501 | 0.298374 | 0.101489 | 00:50 | . input = torch.randn(3,1, requires_grad=True) target = torch.randint(5, (3,), dtype=torch.int64) . input, target . (tensor([[ 0.4705], [-0.4377], [-0.3022]], requires_grad=True), tensor([4, 0, 0])) . input = torch.randn(3, 5) target = torch.randint(5, (3,), dtype=torch.int64) loss = F.cross_entropy(input, target) . input, target, loss . (tensor([[ 0.7829, -0.7753, -0.0460, -0.5882, -1.6432], [-0.9856, -0.7011, -0.1580, 1.7391, -0.3056], [ 1.0284, -0.0924, 1.9061, 0.9941, -0.1425]]), tensor([4, 1, 1]), tensor(2.8817)) . pred = F.softmax(input, dim=1) . def our_cross_entropy(input, target): pred = softmax(input) loss = nl(pred, target) return loss . def softmax(x): return x.exp() / (x.exp().sum(-1)).unsqueeze(-1) def nl(input, target): return -input[range(target.shape[0]), target].log().mean() pred = softmax(input) loss=nl(pred, target) . def inverse(input, target): return . def inverse_loss(input, target): pred = softmax(input) return (1/((pred[range(target.shape[0]), target]).pow(0.15))).mean() . def dot_product_loss(input, target): pred = softmax(input) return -(pred[range(target.shape[0]), target]).mean() . dot_product_loss(input, target) . tensor(-0.5604) . inverse_loss(input, target) . tensor(72.0284) . input . tensor([[ 0.7829, -0.7753, -0.0460, -0.5882, -1.6432], [-0.9856, -0.7011, -0.1580, 1.7391, -0.3056], [ 1.0284, -0.0924, 1.9061, 0.9941, -0.1425]]) . target = torch.tensor([0,3,2]) . x = np.linspace(0.01,0.99,100) . x . array([0.01 , 0.01989899, 0.02979798, 0.03969697, 0.04959596, 0.05949495, 0.06939394, 0.07929293, 0.08919192, 0.09909091, 0.1089899 , 0.11888889, 0.12878788, 0.13868687, 0.14858586, 0.15848485, 0.16838384, 0.17828283, 0.18818182, 0.19808081, 0.2079798 , 0.21787879, 0.22777778, 0.23767677, 0.24757576, 0.25747475, 0.26737374, 0.27727273, 0.28717172, 0.29707071, 0.3069697 , 0.31686869, 0.32676768, 0.33666667, 0.34656566, 0.35646465, 0.36636364, 0.37626263, 0.38616162, 0.39606061, 0.4059596 , 0.41585859, 0.42575758, 0.43565657, 0.44555556, 0.45545455, 0.46535354, 0.47525253, 0.48515152, 0.49505051, 0.50494949, 0.51484848, 0.52474747, 0.53464646, 0.54454545, 0.55444444, 0.56434343, 0.57424242, 0.58414141, 0.5940404 , 0.60393939, 0.61383838, 0.62373737, 0.63363636, 0.64353535, 0.65343434, 0.66333333, 0.67323232, 0.68313131, 0.6930303 , 0.70292929, 0.71282828, 0.72272727, 0.73262626, 0.74252525, 0.75242424, 0.76232323, 0.77222222, 0.78212121, 0.7920202 , 0.80191919, 0.81181818, 0.82171717, 0.83161616, 0.84151515, 0.85141414, 0.86131313, 0.87121212, 0.88111111, 0.8910101 , 0.90090909, 0.91080808, 0.92070707, 0.93060606, 0.94050505, 0.95040404, 0.96030303, 0.97020202, 0.98010101, 0.99 ]) . y_log = -np.log(x) . plt.plot(x, y_log) . [&lt;matplotlib.lines.Line2D at 0x7f3427969438&gt;] . y_inv = 1/np.power(x,0.4) . plt.plot(x, y_inv, label=&#39;inv&#39;) plt.plot(x, y_log, label=&#39;log&#39;) plt.legend() plt.show() . input, target . (tensor([[ 0.7829, -0.7753, -0.0460, -0.5882, -1.6432], [-0.9856, -0.7011, -0.1580, 1.7391, -0.3056], [ 1.0284, -0.0924, 1.9061, 0.9941, -0.1425]]), tensor([4, 1, 1])) . F.softmax(input, dim=1) . tensor([[0.5027, 0.1058, 0.2195, 0.1276, 0.0444], [0.0458, 0.0608, 0.1047, 0.6983, 0.0904], [0.1997, 0.0651, 0.4803, 0.1930, 0.0619]]) . target . tensor([4, 1, 1]) . pred[range(target.shape[0]), target].log() . tensor([-3.1139, -2.7994, -2.7317]) . math.log(0.0444) ,math.log(0.0608) ,math.log(0.0608) . (-3.114515809543958, -2.800165490010016, -2.800165490010016) . pred . tensor([[0.5027, 0.1058, 0.2195, 0.1276, 0.0444], [0.0458, 0.0608, 0.1047, 0.6983, 0.0904], [0.1997, 0.0651, 0.4803, 0.1930, 0.0619]]) . input[range(pred.shape[0]), pred] . IndexError Traceback (most recent call last) &lt;ipython-input-53-c90717f36113&gt; in &lt;module&gt;() -&gt; 1 input[range(pred.shape[0]), pred] IndexError: tensors used as indices must be long, byte or bool tensors . import math . learn = cnn_learner(dls,resnet18, loss_func=F.cross_entropy) . cross_entropy = F.cross_entropy . loss = nn.CrossEntropyLoss() . input = torch.randn(3,5, requires_grad=True) . input . tensor([[ 0.5198, -0.5623, -0.9951, 1.3203, 1.5169], [-0.2748, -0.0607, 0.0349, 0.3257, 0.7164], [ 0.5257, -0.0883, -0.7506, -0.1406, -0.6371]], requires_grad=True) . target = torch.empty(3, dtype=torch.long).random_(5) . target . tensor([3, 4, 2]) . output = loss(input, target) . output . tensor(2.0798, grad_fn=&lt;NllLossBackward&gt;) . &gt;&gt;&gt; loss = nn.CrossEntropyLoss() &gt;&gt;&gt; input = torch.randn(3, 5, requires_grad=True) &gt;&gt;&gt; target = torch.empty(3, dtype=torch.long).random_(5) &gt;&gt;&gt; output = loss(input, target) &gt;&gt;&gt; output.backward() . cross_entropy() . learn.fine_tune(1) . epoch train_loss valid_loss time . 0 | 5.416192 | 00:03 | . KeyboardInterrupt Traceback (most recent call last) &lt;ipython-input-23-ca61b3aa75fc&gt; in &lt;module&gt;() -&gt; 1 learn.fine_tune(1) /usr/local/lib/python3.6/dist-packages/fastai2/callback/schedule.py in fine_tune(self, epochs, base_lr, freeze_epochs, lr_mult, pct_start, div, **kwargs) 155 &#34;Fine tune with `freeze` for `freeze_epochs` then with `unfreeze` from `epochs` using discriminative LR&#34; 156 self.freeze() --&gt; 157 self.fit_one_cycle(freeze_epochs, slice(base_lr), pct_start=0.99, **kwargs) 158 base_lr /= 2 159 self.unfreeze() /usr/local/lib/python3.6/dist-packages/fastai2/callback/schedule.py in fit_one_cycle(self, n_epoch, lr_max, div, div_final, pct_start, wd, moms, cbs, reset_opt) 110 scheds = {&#39;lr&#39;: combined_cos(pct_start, lr_max/div, lr_max, lr_max/div_final), 111 &#39;mom&#39;: combined_cos(pct_start, *(self.moms if moms is None else moms))} --&gt; 112 self.fit(n_epoch, cbs=ParamScheduler(scheds)+L(cbs), reset_opt=reset_opt, wd=wd) 113 114 # Cell /usr/local/lib/python3.6/dist-packages/fastai2/learner.py in fit(self, n_epoch, lr, wd, cbs, reset_opt) 190 try: 191 self.epoch=epoch; self(&#39;begin_epoch&#39;) --&gt; 192 self._do_epoch_train() 193 self._do_epoch_validate() 194 except CancelEpochException: self(&#39;after_cancel_epoch&#39;) /usr/local/lib/python3.6/dist-packages/fastai2/learner.py in _do_epoch_train(self) 163 try: 164 self.dl = self.dls.train; self(&#39;begin_train&#39;) --&gt; 165 self.all_batches() 166 except CancelTrainException: self(&#39;after_cancel_train&#39;) 167 finally: self(&#39;after_train&#39;) /usr/local/lib/python3.6/dist-packages/fastai2/learner.py in all_batches(self) 141 def all_batches(self): 142 self.n_iter = len(self.dl) --&gt; 143 for o in enumerate(self.dl): self.one_batch(*o) 144 145 def one_batch(self, i, b): /usr/local/lib/python3.6/dist-packages/fastai2/data/load.py in __iter__(self) 95 self.randomize() 96 self.before_iter() &gt; 97 for b in _loaders[self.fake_l.num_workers==0](self.fake_l): 98 if self.device is not None: b = to_device(b, self.device) 99 yield self.after_batch(b) /usr/local/lib/python3.6/dist-packages/torch/utils/data/dataloader.py in __next__(self) 343 344 def __next__(self): --&gt; 345 data = self._next_data() 346 self._num_yielded += 1 347 if self._dataset_kind == _DatasetKind.Iterable and /usr/local/lib/python3.6/dist-packages/torch/utils/data/dataloader.py in _next_data(self) 839 840 assert not self._shutdown and self._tasks_outstanding &gt; 0 --&gt; 841 idx, data = self._get_data() 842 self._tasks_outstanding -= 1 843 /usr/local/lib/python3.6/dist-packages/torch/utils/data/dataloader.py in _get_data(self) 806 else: 807 while True: --&gt; 808 success, data = self._try_get_data() 809 if success: 810 return data /usr/local/lib/python3.6/dist-packages/torch/utils/data/dataloader.py in _try_get_data(self, timeout) 759 # (bool: whether successfully get data, any: data if successful else None) 760 try: --&gt; 761 data = self._data_queue.get(timeout=timeout) 762 return (True, data) 763 except Exception as e: /usr/lib/python3.6/multiprocessing/queues.py in get(self, block, timeout) 102 if block: 103 timeout = deadline - time.monotonic() --&gt; 104 if not self._poll(timeout): 105 raise Empty 106 elif not self._poll(): /usr/lib/python3.6/multiprocessing/connection.py in poll(self, timeout) 255 self._check_closed() 256 self._check_readable() --&gt; 257 return self._poll(timeout) 258 259 def __enter__(self): /usr/lib/python3.6/multiprocessing/connection.py in _poll(self, timeout) 412 413 def _poll(self, timeout): --&gt; 414 r = wait([self], timeout) 415 return bool(r) 416 /usr/lib/python3.6/multiprocessing/connection.py in wait(object_list, timeout) 909 910 while True: --&gt; 911 ready = selector.select(timeout) 912 if ready: 913 return [key.fileobj for (key, events) in ready] /usr/lib/python3.6/selectors.py in select(self, timeout) 374 ready = [] 375 try: --&gt; 376 fd_event_list = self._poll.poll(timeout) 377 except InterruptedError: 378 return ready KeyboardInterrupt: . re.search(r&#39;Eat sCake&#39;, &quot;Eat Cake&quot;).group() . &#39;Eat Cake&#39; . Instructions . email_adress = &quot;Please contact us at: support@datacamp.com&quot; . match . from fastai2.vision.all import * . NameError Traceback (most recent call last) &lt;ipython-input-17-97b9dd603d64&gt; in &lt;module&gt;() -&gt; 1 from fastai2.vision.all import * /usr/local/lib/python3.6/dist-packages/fastai2/vision/all.py in &lt;module&gt;() -&gt; 1 from ..basics import * 2 from ..callback.all import * 3 from .augment import * 4 from .core import * 5 from .data import * /usr/local/lib/python3.6/dist-packages/fastai2/basics.py in &lt;module&gt;() -&gt; 1 from .data.all import * 2 from .optimizer import * 3 from .callback.core import * 4 from .learner import * 5 from .metrics import * /usr/local/lib/python3.6/dist-packages/fastai2/data/all.py in &lt;module&gt;() -&gt; 1 from ..torch_basics import * 2 from .core import * 3 from .load import * 4 from .external import * 5 from .transforms import * /usr/local/lib/python3.6/dist-packages/fastai2/torch_basics.py in &lt;module&gt;() 3 from .torch_imports import * 4 from .torch_core import * -&gt; 5 from .layers import * /usr/local/lib/python3.6/dist-packages/fastai2/layers.py in &lt;module&gt;() 271 272 # Cell --&gt; 273 @log_args 274 @funcs_kwargs 275 class BaseLoss(): NameError: name &#39;log_args&#39; is not defined . from fastai2 import * . from fastai2.vision.all import untar_data . NameError Traceback (most recent call last) &lt;ipython-input-2-8f947d7598e8&gt; in &lt;module&gt;() -&gt; 1 from fastai2.vision.all import untar_data /usr/local/lib/python3.6/dist-packages/fastai2/vision/all.py in &lt;module&gt;() -&gt; 1 from ..basics import * 2 from ..callback.all import * 3 from .augment import * 4 from .core import * 5 from .data import * /usr/local/lib/python3.6/dist-packages/fastai2/basics.py in &lt;module&gt;() -&gt; 1 from .data.all import * 2 from .optimizer import * 3 from .callback.core import * 4 from .learner import * 5 from .metrics import * /usr/local/lib/python3.6/dist-packages/fastai2/data/all.py in &lt;module&gt;() -&gt; 1 from ..torch_basics import * 2 from .core import * 3 from .load import * 4 from .external import * 5 from .transforms import * /usr/local/lib/python3.6/dist-packages/fastai2/torch_basics.py in &lt;module&gt;() 3 from .torch_imports import * 4 from .torch_core import * -&gt; 5 from .layers import * /usr/local/lib/python3.6/dist-packages/fastai2/layers.py in &lt;module&gt;() 271 272 # Cell --&gt; 273 @log_args 274 @funcs_kwargs 275 class BaseLoss(): NameError: name &#39;log_args&#39; is not defined . from . path = untar_data . NameError Traceback (most recent call last) &lt;ipython-input-5-1e2030e93c93&gt; in &lt;module&gt;() -&gt; 1 path = untar_data NameError: name &#39;untar_data&#39; is not defined . !pip install fastai2 . Requirement already satisfied: fastai2 in /usr/local/lib/python3.6/dist-packages (0.0.17) Requirement already satisfied: matplotlib in /usr/local/lib/python3.6/dist-packages (from fastai2) (3.2.1) Requirement already satisfied: fastcore in /usr/local/lib/python3.6/dist-packages (from fastai2) (0.1.16) Requirement already satisfied: pyyaml in /usr/local/lib/python3.6/dist-packages (from fastai2) (3.13) Requirement already satisfied: torch&gt;=1.3.0 in /usr/local/lib/python3.6/dist-packages (from fastai2) (1.4.0) Requirement already satisfied: scikit-learn in /usr/local/lib/python3.6/dist-packages (from fastai2) (0.22.2.post1) Requirement already satisfied: fastprogress&gt;=0.1.22 in /usr/local/lib/python3.6/dist-packages (from fastai2) (0.2.3) Requirement already satisfied: spacy in /usr/local/lib/python3.6/dist-packages (from fastai2) (2.2.4) Requirement already satisfied: pillow in /usr/local/lib/python3.6/dist-packages (from fastai2) (7.0.0) Requirement already satisfied: scipy in /usr/local/lib/python3.6/dist-packages (from fastai2) (1.4.1) Requirement already satisfied: requests in /usr/local/lib/python3.6/dist-packages (from fastai2) (2.21.0) Requirement already satisfied: pandas in /usr/local/lib/python3.6/dist-packages (from fastai2) (1.0.3) Requirement already satisfied: torchvision&gt;=0.5 in /usr/local/lib/python3.6/dist-packages (from fastai2) (0.5.0) Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.6/dist-packages (from matplotlib-&gt;fastai2) (0.10.0) Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib-&gt;fastai2) (1.2.0) Requirement already satisfied: numpy&gt;=1.11 in /usr/local/lib/python3.6/dist-packages (from matplotlib-&gt;fastai2) (1.18.2) Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib-&gt;fastai2) (2.4.7) Requirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib-&gt;fastai2) (2.8.1) Requirement already satisfied: dataclasses&gt;=&#39;0.7&#39;; python_version &lt; &#34;3.7&#34; in /usr/local/lib/python3.6/dist-packages (from fastcore-&gt;fastai2) (0.7) Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.6/dist-packages (from scikit-learn-&gt;fastai2) (0.14.1) Requirement already satisfied: srsly&lt;1.1.0,&gt;=1.0.2 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (1.0.2) Requirement already satisfied: catalogue&lt;1.1.0,&gt;=0.0.7 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (1.0.0) Requirement already satisfied: setuptools in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (46.1.3) Requirement already satisfied: blis&lt;0.5.0,&gt;=0.4.0 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (0.4.1) Requirement already satisfied: preshed&lt;3.1.0,&gt;=3.0.2 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (3.0.2) Requirement already satisfied: murmurhash&lt;1.1.0,&gt;=0.28.0 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (1.0.2) Requirement already satisfied: plac&lt;1.2.0,&gt;=0.9.6 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (1.1.3) Requirement already satisfied: wasabi&lt;1.1.0,&gt;=0.4.0 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (0.6.0) Requirement already satisfied: tqdm&lt;5.0.0,&gt;=4.38.0 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (4.38.0) Requirement already satisfied: cymem&lt;2.1.0,&gt;=2.0.2 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (2.0.3) Requirement already satisfied: thinc==7.4.0 in /usr/local/lib/python3.6/dist-packages (from spacy-&gt;fastai2) (7.4.0) Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.6/dist-packages (from requests-&gt;fastai2) (2020.4.5.1) Requirement already satisfied: idna&lt;2.9,&gt;=2.5 in /usr/local/lib/python3.6/dist-packages (from requests-&gt;fastai2) (2.8) Requirement already satisfied: urllib3&lt;1.25,&gt;=1.21.1 in /usr/local/lib/python3.6/dist-packages (from requests-&gt;fastai2) (1.24.3) Requirement already satisfied: chardet&lt;3.1.0,&gt;=3.0.2 in /usr/local/lib/python3.6/dist-packages (from requests-&gt;fastai2) (3.0.4) Requirement already satisfied: pytz&gt;=2017.2 in /usr/local/lib/python3.6/dist-packages (from pandas-&gt;fastai2) (2018.9) Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from torchvision&gt;=0.5-&gt;fastai2) (1.12.0) Requirement already satisfied: importlib-metadata&gt;=0.20; python_version &lt; &#34;3.8&#34; in /usr/local/lib/python3.6/dist-packages (from catalogue&lt;1.1.0,&gt;=0.0.7-&gt;spacy-&gt;fastai2) (1.6.0) Requirement already satisfied: zipp&gt;=0.5 in /usr/local/lib/python3.6/dist-packages (from importlib-metadata&gt;=0.20; python_version &lt; &#34;3.8&#34;-&gt;catalogue&lt;1.1.0,&gt;=0.0.7-&gt;spacy-&gt;fastai2) (3.1.0) . %%capture import sys if &#39;google.colab&#39; in sys.modules: !pip install git+git://github.com/fastai/fastai2.git from fastai2.vision.all import * . NameError Traceback (most recent call last) &lt;ipython-input-1-ad350d9a0008&gt; in &lt;module&gt;() 3 get_ipython().system(&#39;pip install git+git://github.com/fastai/fastai2.git&#39;) 4 -&gt; 5 from fastai2.vision.all import * /usr/local/lib/python3.6/dist-packages/fastai2/vision/all.py in &lt;module&gt;() -&gt; 1 from ..basics import * 2 from ..callback.all import * 3 from .augment import * 4 from .core import * 5 from .data import * /usr/local/lib/python3.6/dist-packages/fastai2/basics.py in &lt;module&gt;() -&gt; 1 from .data.all import * 2 from .optimizer import * 3 from .callback.core import * 4 from .learner import * 5 from .metrics import * /usr/local/lib/python3.6/dist-packages/fastai2/data/all.py in &lt;module&gt;() -&gt; 1 from ..torch_basics import * 2 from .core import * 3 from .load import * 4 from .external import * 5 from .transforms import * /usr/local/lib/python3.6/dist-packages/fastai2/torch_basics.py in &lt;module&gt;() 3 from .torch_imports import * 4 from .torch_core import * -&gt; 5 from .layers import * /usr/local/lib/python3.6/dist-packages/fastai2/layers.py in &lt;module&gt;() 271 272 # Cell --&gt; 273 @log_args 274 @funcs_kwargs 275 class BaseLoss(): NameError: name &#39;log_args&#39; is not defined . path = untar_data(&#39;https://storage.googleapis.com/ml-animal-sounds-datasets/macaques_24414Hz.zip&#39;) def get_items(path): return get_files(path) def get_y(path): return path.parent.stem def get_x(path, target_rate=24414, num_samples=18310): n_fft = 1024 hop_length = 30 x, rate = torchaudio.load_wav(path) if rate != target_rate: x = torchaudio.transforms.Resample(orig_freq=rate, new_freq=24414, resampling_method=&#39;sinc_interpolation&#39;)(x) x = x[0] / 32767 x = x.numpy() x = librosa.util.fix_length(x, num_samples) x = librosa.util.pad_center(x, num_samples, mode=&#39;constant&#39;) stft = librosa.stft(x, n_fft=n_fft, hop_length=hop_length) stft_magnitude, stft_phase = librosa.magphase(stft) stft_magnitude_db = librosa.amplitude_to_db(stft_magnitude) stft_magnitude_db = stft_magnitude_db - stft_magnitude_db.min() stft_magnitude_db = stft_magnitude_db / stft_magnitude_db.max() * 255 # we want the range of values for our data to be [0, 255] # this way fastai internally will be able to represent it as an image using PIL return stft_magnitude_db.astype(np.uint8) . #mel_spect = librosa.feature.melspectrogram(y=y, sr=sr, n_fft=2048, hop_length=1024) . db = DataBlock( blocks=(ImageBlock, CategoryBlock), get_items=get_items, get_x=get_x, get_y=get_y, splitter=RandomSplitter(seed=42)) . dls = db.dataloaders(path, num_workers=12) . dls.show_batch() . learn = cnn_learner(dls, resnet18, metrics=error_rate) learn.fine_tune(2) . epoch train_loss valid_loss error_rate time . 0 | 0.620329 | 0.583106 | 0.179822 | 04:12 | . epoch train_loss valid_loss error_rate time . 0 | 0.168138 | 0.167591 | 0.057653 | 04:14 | . 1 | 0.071456 | 0.042807 | 0.015100 | 04:13 | . # interp = ClassificationInterpretation.from_learner(learn) # interp.plot_confusion_matrix(figsize=(12,12), dpi=60) .",
            "url": "https://dienhoa.github.io/dhoa.github.io/2020/04/29/loss_func.html",
            "relUrl": "/2020/04/29/loss_func.html",
            "date": " • Apr 29, 2020"
        }
        
    
  

  
  

  
      ,"page1": {
          "title": "About Me",
          "content": "This is where you put the contents of your About page. Like all your pages, it’s in Markdown format. . This website is powered by fastpages 1. . a blogging platform that natively supports Jupyter notebooks in addition to other formats. &#8617; . |",
          "url": "https://dienhoa.github.io/dhoa.github.io/about/",
          "relUrl": "/about/",
          "date": ""
      }
      
  

  

  
  

  

  
  

  

  
  

  
  

  
  

  
      ,"page10": {
          "title": "",
          "content": "Sitemap: {{ “sitemap.xml” | absolute_url }} | .",
          "url": "https://dienhoa.github.io/dhoa.github.io/robots.txt",
          "relUrl": "/robots.txt",
          "date": ""
      }
      
  

}